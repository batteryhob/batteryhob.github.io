---
layout: post
title:  ì¿ ë²„ë„¤í‹°ìŠ¤ì— GitOpsë„êµ¬ ì„¤ì¹˜í•˜ê¸° (ArgoCD)
date:   2021-06-09 00:00:00 +0900
author: ì „ì§€í˜¸
tags: kubernetes helm gitops mlops
excerpt: 
use_math: false
toc: true
# tags: ìë™ ìˆ˜ì§‘ë˜ëŠ” íƒœê·¸ ë„ì–´ì“°ê¸°ë¡œ êµ¬ë¶„, ë°˜ë“œì‹œ ì†Œë¬¸ìë¡œ ì‚¬ìš©
# excerpt: ë©”ì¸ í™”ë©´ì— ë…¸ì¶œë˜ëŠ” postì˜ description
# use_math : ìˆ˜ì‹ì´ í•„ìš” í•  ê²½ìš°(ìœ— ì²¨ì, ì•„ë«ì²¨ì ë™ì‹œ ì‚¬ìš© ë¶ˆê°€) true | false
# toc : ëª©ì°¨ê°€ í•„ìš” í•  ê²½ìš° true | false
---


# ì¿ ë²„ë„¤í‹°ìŠ¤ì— GitOps ë„êµ¬ ì„¤ì¹˜í•˜ê¸° ArgoCD ğŸ™

> ì¿ ë²„ë„¤í‹°ìŠ¤ì— ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ìë™ ë°°í¬í•´ì£¼ëŠ” CI/CDë¥¼ êµ¬ì¶•í•´ë´…ì‹œë‹¤.

ArgoCDì˜ ë§ˆìŠ¤ì½”íŠ¸ëŠ” ë¬¸ì–´ì…ë‹ˆë‹¤. ì•„ë§ˆë„ ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ì„ ìƒì§•í•˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤. ğŸ™

<br/>

## ê°œìš”

<hr/>

> argocdëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ ì „ìš© CI/CD ë„êµ¬ì…ë‹ˆë‹¤. helm ì†ŒìŠ¤ê°€ ì €ì¥ëœ git repogitory ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.

helmì˜ ì†ŒìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•˜ê¸° ë•Œë¬¸ì—, ì¿ ë²„ë„¤í‹°ìŠ¤ì•ˆì˜ ëª¨ë“  ìš”ì†Œë¥¼ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

jenkinsë“± ë‹¤ë¥¸ CI/CD ë„êµ¬ê°€ ì½”ë“œ ê¸°ë°˜ìœ¼ë¡œ ëœ í”„ë¡œì íŠ¸ì— ì‚¬ìš©ëœë‹¤ë©´,

ì½”ë“œ + ë„ì»¤ ì´ë¯¸ì§€ë¡œ ì´ë£¨ì–´ì§„ í”„ë¡œì íŠ¸ì— ì‚¬ìš©ë˜ëŠ” CI/CD ë„êµ¬ì…ë‹ˆë‹¤.

ë³¸ í¬ìŠ¤íŠ¸ëŠ” argocdì˜ ì„¤ëª…ë³´ë‹¤ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤(aws eks)ì— ì„¤ì¹˜í•˜ê³  ì´ˆê¸° ì„¤ì •í•˜ëŠ” ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.

<br/>

## argo-cli ì„¤ì¹˜í•˜ê¸°

<hr/>

> argocdì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆëŠ” cli(ì»¤ë§¨ë“œ ë¼ì¸ ì¸í„°í˜ì´ìŠ¤) ì„¤ì¹˜í•´ë´…ì‹œë‹¤. 
>> í„°ë¯¸ë„ì—ì„œ argocdì˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤.

ì¼ë‹¨ ì•„ë˜ ë§í¬ë¡œ ë“¤ì–´ê°€ argo-cli ë‹¤ìš´ë¡œë“œ í•©ë‹ˆë‹¤.

ì°¸ê³ ë¡œ, ê³µì‹ì ìœ¼ë¡œëŠ” windowsë¥¼ ì§€ì›í•˜ì§€ ì•Šìœ¼ë‚˜, ë³¸ í¬ìŠ¤íŠ¸ì˜ ë‚´ìš©ì˜ windowsë¥¼ ì§€ì›í•˜ë„ë¡ ì“°ì—¬ì¡ŒìŠµë‹ˆë‹¤.

ğŸ‘‰ [<u>argo-cli ë‹¤ìš´ë¡œë“œ ë§í¬</u>](https://github.com/argoproj/argo-cd/releases/tag/v2.0.1)

 ![<u>argo-cli ìœˆë„ìš°ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŒ</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argowindow%EC%A7%80%EC%9B%90.JPG){ :popup }

ë‹¤ìš´ë¡œë“œ í›„, ì••ì¶•ì„ í•´ì œí•œ ë’¤ íŒŒì¼ì„ í™•ì¸í•´ ë´…ë‹ˆë‹¤.

![<u>argo-cli íŒŒì¼í™•ì¸</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argocli%ED%8C%8C%EC%9D%BC.JPG){ :popup }

í™˜ê²½ ë³€ìˆ˜ì— ì••ì¶• í‘¼ íŒŒì¼ ìœ„ì¹˜ë¥¼ ë“±ë¡í•´ì¤ë‹ˆë‹¤.

![<u>í™˜ê²½ë³€ìˆ˜ ë“±ë¡</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argowindow%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98.JPG){ :popup }

í„°ë¯¸ë„ì—ì„œ ëª…ë ¹ì–´ê°€ ì‚¬ìš©ê°€ëŠ¥í•œì§€ í™•ì¸í•´ë´…ì‹œë‹¤.

``` shell
argocd
```

![<u>í™˜ê²½ë³€ìˆ˜ ë“±ë¡</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argowindow%ED%84%B0%EB%AF%B8%EB%84%90.JPG){ :popup }

<br/>

## argoCD ì„¤ì¹˜

<hr/>

> ë³¸ê²©ì ìœ¼ë¡œ ì„¤ì¹˜ë¥¼ ì§„í–‰í•´ë´…ë‹ˆë‹¤.

kubectl ëª…ë ¹ì–´ë¥¼ ì´ìš©í•˜ì—¬, í´ëŸ¬ìŠ¤í„°ì— ì„¤ì¹˜ê°€ ê°€ëŠ¥í•œ ë…¸ë“œê°€ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

``` shell
kubectl get node
```

argocdê°€ ì„¤ì¹˜ë  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•´ì¤ë‹ˆë‹¤.

``` shell
kubectl create namespace argocd
```

ìƒì„±í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ê³µì‹ yamlì„ ì´ìš©í•´ ê°€ì¥ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì„¤ì¹˜í•´ì¤ì‹œë‹¤.

``` shell
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
```

ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆëŠ” ì§€ í™•ì¸í•˜ë ¤ë©´, ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ í†µí•´ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

``` shell
kubectl get pod -n argocd
```

![<u>ì„¤ì¹˜ì¤‘</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argocd%EC%84%A4%EC%B9%98%EC%A4%91.JPG)

![<u>ì„¤ì¹˜ì™„ë£Œ</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argocd%EC%84%A4%EC%B9%98%EC%99%84%EB%A3%8C.JPG)

<br/>

## argoCD ì´ˆê¸° ì„¤ì •

<hr/>

ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìœ¼ë©´, ë¡œë“œë°¸ëŸ°ì„œ ì„¤ì •ì„ í†µí•´ ì™¸ë¶€ì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ê²Œ í•´ì•¼í•©ë‹ˆë‹¤.

ì•„ë˜ ëª…ë ¹ì–´ëŠ” linuxëª…ë ¹ì–´ ì´ë¯€ë¡œ windowsë¼ë©´ Gitbashì—ì„œ ì…ë ¥í•´ì£¼ì„¸ìš”.

``` shell
kubectl patch svc argocd-server -n argocd -p '{"spec": {"type": "LoadBalancer"}}'
```

![<u>ì™¸ë¶€ì ‘ê·¼</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argocd%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%84%9C%EB%85%B8%EC%B6%9C.JPG)

ë¡œë¸Œë°¸ëŸ°ì„œ ì„¤ì •ì´ ë³€ê²½ë˜ì—ˆìœ¼ë©´, 

ë¡œê·¸ì¸ì„ ìœ„í•´ ëœë¤ ì„¤ì •ëœ ìµœì´ˆ ë¹„ë°€ë²ˆí˜¸ì„ í™•ì¸í•´ë´…ì‹œë‹¤.

ì°¸ê³ ë¡œ, ì•„ì´ë””ëŠ” `admin`ìœ¼ë¡œ ê³ ì •ì…ë‹ˆë‹¤.

ì•„ë˜ ëª…ë ¹ì–´ëŠ” linuxëª…ë ¹ì–´ ì´ë¯€ë¡œ windowsë¼ë©´ Gitbashì—ì„œ ì…ë ¥í•´ì£¼ì„¸ìš”.

``` shell
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath="{.data.password}" | base64 -d
```

![<u>ìµœì´ˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argocd%EC%B5%9C%EC%B4%88%EB%B9%84%EB%B0%80%EB%B2%88%ED%98%B8%EC%95%8C%EA%B8%B0.JPG)

ì´ì œ ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ ì ‘ì†í•´ë´…ì‹œë‹¤.

ë¡œë“œë°¸ëŸ°ì„œ ì„¤ì •ì´ ì™„ë£Œë˜ì—ˆë‹¤ë©´, í˜¸ìŠ¤íŠ¸ëŠ” ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![<u>í˜¸ìŠ¤íŠ¸ í™•ì¸</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argocd%ED%98%B8%EC%8A%A4%ED%8A%B8%EC%A3%BC%EC%86%8C%ED%99%95%EC%9D%B8.png)

ì •ìƒì ìœ¼ë¡œ ì„¤ì¹˜ë˜ì—ˆë‹¤ë©´, ë‹¤ìŒ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤,.

![<u>ì ‘ì†</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argo%EC%A0%91%EC%86%8D.JPG)

ë¡œê·¸ì¸ í›„ì— ë‹¤ìŒ í™”ë©´ì„ ë³¼ ìˆ˜ìˆìŠµë‹ˆë‹¤.

![<u>ë¡œê·¸ì¸</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argo%EC%A0%91%EC%86%8D2.JPG)

<br/>

## ì„ íƒì‚¬í•­(ë¹„ë°€ë²ˆí˜¸ ë³€ê²½, cliì— ì»¨í…ìŠ¤íŠ¸ ë“±ë¡)

<hr/>

í„°ë¯¸ë„ì—ì„œ ë¡œê·¸ì¸ì„ í•˜ê³ , ë¹„ë°€ë²ˆí˜¸ë¥¼ ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤.

``` shell
argocd login ì„œë²„ëª… #ë¡œê·¸ì¸ ëª…ë ¹ì–´
argocd account update-password #ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
```

![<u>ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</u>](https://solution-userstats.s3.ap-northeast-1.amazonaws.com/techblogs/batteryho/argocd/argo%ED%84%B0%EB%AF%B8%EB%84%90%EB%A1%9C%EA%B7%B8%EC%9D%B8.JPG)

ì¿ ë²„ë„¤í‹°ìŠ¤ contextì— ì¶”ê°€í•©ë‹ˆë‹¤.

``` shell
kubectl config get-contexts -o name
argocd cluster add ì»¨í…ìŠ¤íŠ¸ì´ë¦„
```

<br/>

## ì°¸ê³ ë¬¸í—Œ

<hr/>

ë” ìì„¸í•œ ì •ë³´ëŠ” ê³µì‹ ê°€ì´ë“œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

ğŸ™ğŸ™ğŸ™

ğŸ‘‰ [<u>argo-cd guide</u>](https://argoproj.github.io/argo-cd/user-guide)